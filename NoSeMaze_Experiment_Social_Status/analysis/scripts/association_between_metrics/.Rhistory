library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log10((NorKetConc_D2_Post)/log(KetConc_D2_Post))  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2)
cor.test(df_plot$RelChange_MADRS_D3, df_plot$log_NK_over_K_D2, method = "spearman")
cor.test(df_plot$RelChange_MADRS_D3, df_plot$log_NK_over_K_D2, method = "spearman")
library(tidyverse)
# Daten in long-Format bringen für D2 Post
df_plot <- df_wide %>%
select(PatID,
KetConc_D2_Post,
NorKetConc_D2_Post,
DehydronorKetConc_D2_Post) %>%
pivot_longer(
cols = c(KetConc_D2_Post, NorKetConc_D2_Post, DehydronorKetConc_D2_Post),
names_to = "Analyte",
values_to = "Concentration"
) %>%
mutate(Analyte = recode(Analyte,
"KetConc_D2_Post" = "Ketamine",
"NorKetConc_D2_Post" = "Norketamine",
"DehydronorKetConc_D2_Post" = "Dehydronorketamine"))
# Boxplot + Punkte
ggplot(df_plot, aes(x = Analyte, y = Concentration, fill = Analyte)) +
geom_boxplot(alpha = 0.5, outlier.shape = NA) +
geom_jitter(width = 0.2, size = 2, alpha = 0.7) +
labs(title = "Post-infusion concentrations at D2",
x = "",
y = "Concentration (ng/mL)") +
theme_minimal(base_size = 14) +
theme(legend.position = "none")
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log10((NorKetConc_D2_Post)/log(KetConc_D2_Post))  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
df_plot$RelChange_MADRS_D3
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log10((NorKetConc_D2_Post)/(KetConc_D2_Post))  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(RelChange_MADRS_D3,log_NK_over_K_D2,Method='Spearman')
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log10((NorKetConc_D2_Post+0.5)/(KetConc_D2_Post+0.5))  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log((NorKetConc_D2_Post+0.5)/(KetConc_D2_Post+0.5))  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log((NorKetConc_D2_Post)/(KetConc_D2_Post))  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = -log((NorKetConc_D2_Post)/(KetConc_D2_Post))  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = -log((NorKetConc_D2_Post+1)/(KetConc_D2_Post+1))  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log((NorKetConc_D2_Post)/(KetConc_D2_Post))  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log(NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = (NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = (NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Pearson')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = (NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log(NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log(NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Pearson')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log(NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log(NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method="Spearman")
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log(NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method="spearman")
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log(NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,method="spearman")
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = (NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log(NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log(NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,method='spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = (NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,Method='Spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = (NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,method='spearman')
library(dplyr)
library(ggplot2)
# --- 1. Relative change in MADRS (D3 vs D1) ---
df_plot <- df_wide %>%
mutate(
RelChange_MADRS_D3 = 100 * (MADRS_D3 - MADRS_D1) / MADRS_D1,
log_NK_over_K_D2   = log(NorKetConc_D2_Post/KetConc_D2_Post)  # small offset for safety
) %>%
select(PatID, RelChange_MADRS_D3, log_NK_over_K_D2)
# --- 2. Plot ---
ggplot(df_plot, aes(x = log_NK_over_K_D2, y = RelChange_MADRS_D3)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", se = TRUE, color = "blue") +
labs(
x = "log(NorKetamine / Ketamine) at D2 post infusion",
y = "Relative change in MADRS (%) from D1 to D3",
title = "Relationship between log(NK/K) at D2 and MADRS relative change (D1→D3)"
) +
theme_minimal(base_size = 14)
cor.test(df_plot$RelChange_MADRS_D3,df_plot$log_NK_over_K_D2,method='spearman')
